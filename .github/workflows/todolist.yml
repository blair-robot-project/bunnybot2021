name: Automated ToDo List Generator
on: [workflow_dispatch]
jobs:
  generate-todo-list:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Generate List
        run: |
          readarray -t todos < <(egrep -nri '\/+\**\ *todo' src/main/ | sed -e 's/: */: /g')
          important=()
          nonimportant=()
          for todo in "${todos[@]"
          do
            if ("$todo" = *"[IMPORTANT]"*)
            then
              important+="$todo"
            else
              nonimportant+="$todo"
            fi
          done
          echo "Important TODOs:" > todolist.txt
          for todo in "${important[@]}"
          do
            echo "$todo" >> todolist.txt
          done
          echo "---------------------------------------------------------------------------------------------------------" >> todolist.txt
          echo "Non-important TODOs:" >> todolist.txt
          for todo in "${nonimportant[@]}"
          do
            echo "$todo" >> todolist.txt
          done
      - name: Git Config
        run: |
          git config user.name "ToDo List Generator"
          git config user.email "<>"
      - name: Commit List
        run: |
          git add todolist.txt
          git commit -m "Update ToDo List"
          git push origin main
